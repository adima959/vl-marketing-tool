#!/bin/sh
# Pre-push hook: runs architecture gate tests before pushing.
# Prevents pushing code that breaks CRM query consistency rules.

echo "Running architecture gate tests..."
npx vitest run tests/integration/ --reporter=verbose 2>&1

if [ $? -ne 0 ]; then
  echo ""
  echo "Push blocked: architecture gate tests failed."
  echo "Fix the issues above before pushing."
  exit 1
fi

echo "All gate tests passed."
